<script>
    function alteraNotaConhecimento() {
        if (goSlNota.value == "nf_nume") {
            goNrNota.placeholder = "DIGITE O NÚMERO DA NOTA FISCAL";
        }
        else if (goSlNota.value == "ct_nume") {
            goNrNota.placeholder = "DIGITE O NÚMERO DO CONHECIMENTO";
        }
    }

    function alteraCnpjCpf() {
        if (goSlCnpj.value == "cnpj") {
            goTxCnpj.style.display = "";
            goTxNcpf.style.display = "none";
        }
        else if (goSlCnpj.value == "cpf") {
            goTxCnpj.style.display = "none";
            goTxNcpf.style.display = "";
        }
    }

    function rastreiaCarga() {
        if (sltCnpj.value == "cnpj" && !validaCnpj(txtCnpj.value)) {
            goDvErro.style.display = "";
            goDvErro.innerHTML = "CNPJ INVÁLIDO";
            return;
        }
        else if (goSlCnpj.value == "cpf" && !validaCpf(txtNcpf.value)) {
            goDvErro.style.display = "";
            goDvErro.innerHTML = "CPF INVÁLIDO";
            return;
        }

        if (goNrNota.value.trim() == "") {
            goDvErro.style.display = "";

            if (goSlNota.value == "nf_nume") { goDvErro.innerHTML = "NÚMERO DA NOTA FISCAL INVÁLIDO"; }
            else if (goSlNota.value == "ct_nume") { goDvErro.innerHTML = "NÚMERO DO CONHECIMENTO INVÁLIDO"; }

            return;
        }

        goDvErro.style.display = "none";
        goDvErro.innerHTML = "";

        var lcCtNume = "", lcNfNume = "", lcReCnpj = "", lcReNcpf = "", lcDeCnpj = "", lcDeNcpf = "";

        if (goSlNota.value == "nf_nume") {
            lcNfNume = "=" + goNrNota.value;
            lcCtNume = ":IsNull=True";
        }
        else {
            lcNfNume = ":IsNull=True";
            lcCtNume = "=" + goNrNota.value;
        }

        if (goSlRede.value == "remetente") {
            if (goSlCnpj.value == "cnpj") {
                lcReCnpj = "=" + goTxCnpj.value.replace(/[^\d]+/g, '');
                lcReNcpf = ":IsNull=True";
            }
            else {
                lcReCnpj = ":IsNull=True";
                lcReNcpf = "=" + goTxNcpf.value.replace(/[^\d]+/g, '');
            }

            lcDeCnpj = ":IsNull=True";
            lcDeNcpf = ":IsNull=True";
        }
        else {
            if (goSlCnpj.value == "cnpj") {
                lcDeCnpj = "=" + goTxNcpf.value.replace(/[^\d]+/g, '');
                lcDeNcpf = ":IsNull=True";
            }
            else {
                lcDeCnpj = ":IsNull=True";
                lcDeNcpf = "=" + goTxNcpf.value.replace(/[^\d]+/g, '');
            }
            lcReCnpj = ":IsNull=True";
            lcReNcpf = ":IsNull=True";
        }
		
		$.ajax({
            url: pcWsHttp + "consultaConhecimento?lcIdEmpr=STN&lcCtNume" + lcCtNume + "&lcNfNume" + lcNfNume + "&lcReCnpj" + lcReCnpj + "&lcReNcpf" + lcReNcpf + "&lcDeCnpj" + lcDeCnpj + "&lcDeNcpf" + lcDeNcpf,
            type: "GET",
            dataType: "jsonp",
            contentType: "application/json; charset=utf-8",

            success: function (loWkRsql) {
                try {
                    if (loWkRsql.id_ctrc > 0) {
                        goDvCtrc.style.display = "";

                        goSpNume.innerHTML = loWkRsql.ct_nume.toString().trim();
                        goSpData.innerHTML = loWkRsql.ct_data;
                        //goSpFlor.innerHTML = loWkRsql.;
                        goSpFldt.innerHTML = loWkRsql.fd_cida;

                        if (loWkRsql.ct_tfre == 1) { goSpTfre.innerHTML = "CIF"; }
                        else { goSpTfre.innerHTML = "FOB"; }

                        goSpNomr.innerHTML = loWkRsql.re_nome;
                        goSpCgcr.innerHTML = loWkRsql.re_cnpj;
                        goSpNomd.innerHTML = loWkRsql.de_nome;
                        goSpCgcd.innerHTML = loWkRsql.de_cnpj;
                    }
                    else {
                        goDvCtrc.style.display = "none";
                        goDvErro.style.display = "";
                        goDvErro.innerHTML = "NENHUM CONHECIMENTO ENCONTRADO";
                    }
                }
                catch (loWkErro) {
                    goDvCtrc.style.display = "none";
                    goDvErro.style.display = "";
                    goDvErro.innerHTML = "NENHUM CONHECIMENTO ENCONTRADO";
                }
            },
            error: function () {
                goDvCtrc.style.display = "none";
                goDvErro.style.display = "";
                goDvErro.innerHTML = "NENHUM CONHECIMENTO ENCONTRADO";
            }
        });
    }

    //@ sourceURL=RasCar1.js
</script>

<div class="panel panel-primary">
    <div class="panel-heading">RASTREIE SUA CARGA</div>
    <div class="panel-body">
        <table style="width: 100%;">
            <tr>
                <td colspan="2">
                    <select id="sltRede" class="form-control">
                        <option value="destinatario">DESTINATÁRIO</option>
                        <option value="remetente">REMETENTE</option>
                    </select>
                </td>
            </tr>
            <tr>
                <td colspan="2">
                    &nbsp;
                </td>
            </tr>
            <tr>
                <td>
                    <select id="sltCnpj" class="form-control" onchange="alteraCnpjCpf();">
                        <option value="cnpj">CNPJ</option>
                        <option value="cpf">CPF</option>
                    </select>
                </td>
                <td>
                    <input id="txtCnpj" type="text" class="form-control maskCnpj" placeholder="DIGITE O CNPJ">
                    <input id="txtNcpf" type="text" class="form-control maskNcpf" placeholder="DIGITE O CPF" style="display: none;">
                </td>
            </tr>
            <tr>
                <td colspan="2">
                    &nbsp;
                </td>
            </tr>
            <tr>
                <td>
                    <select id="sltNota" class="form-control" onchange="alteraNotaConhecimento();">
                        <option value="nf_nume">NOTA FISCAL</option>
                        <option value="ct_nume">CONHECIMENTO</option>
                    </select>
                </td>
                <td>
                    <input id="nroNota" type="number" class="form-control" placeholder="DIGITE O NÚMERO DA NOTA FISCAL">
                </td>
            </tr>
            <tr>
                <td colspan="2">
                    &nbsp;
                </td>
            </tr>
            <tr>
                <td colspan="2" style="text-align: right;">
                    <button id="btnRast" type="button" class="btn btn-primary" style="border-radius: 4px !important;" onclick="rastreiaCarga();">RASTREAR</button>
                </td>
            </tr>
        </table>
    </div>
</div>
<br />
<div id="divErro" class="alert alert-danger" role="alert" style="display: none;"></div>
<br />
<div id="divCtrc" class="panel panel-primary" style="display: none;">
    <div class="panel-heading">CONHECIMENTO</div>
    <div class="panel-body">
        <table style="width: 100%;">
            <tr>
                <td style="text-align: right;">
                    NÚMERO DO CONHECIMENTO:
                </td>
                <td>
                    <b><span id="spnNume"></span></b>
                </td>
                <td style="text-align: right;">
                    DATA EMISSÃO:
                </td>
                <td>
                    <b><span id="spnData"></span></b>
                </td>
            </tr>
            <tr>
                <td colspan="4">
                    &nbsp;
                </td>
            </tr>
            <tr>
                <td style="text-align: right;">
                    FILIAL ORIGEM:
                </td>
                <td>
                    <b><span id="spnFlor"></span></b>
                </td>
                <td style="text-align: right;">
                    FILIAL DESTINO:
                </td>
                <td>
                    <b><span id="spnFldt"></span></b>
                </td>
            </tr>
            <tr>
                <td colspan="4">
                    &nbsp;
                </td>
            </tr>
            <tr>
                <td style="text-align: right;">
                    TIPO DE FRETE:
                </td>
                <td colspan="3">
                    <b><span id="spnTfre"></span></b>
                </td>
            </tr>
            <tr>
                <td colspan="4">
                    &nbsp;
                </td>
            </tr>
            <tr>
                <td colspan="4">
                    <div class="panel panel-primary">
                        <div class="panel-heading">REMETENTE</div>
                        <div class="panel-body">
                            <table style="width: 100%;">
                                <tr>
                                    <td>
                                        NOME:
                                    </td>
                                    <td>
                                        <b><span id="spnNomr"></span></b>
                                    </td>
                                    <td>
                                        CNPJ/CPF:
                                    </td>
                                    <td>
                                        <b><span id="spnCgcr"></span></b>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </td>
            </tr>
            <tr>
                <td colspan="4">
                    <div class="panel panel-primary">
                        <div class="panel-heading">DESTINATÁRIO</div>
                        <div class="panel-body">
                            <table style="width: 100%;">
                                <tr>
                                    <td>
                                        NOME:
                                    </td>
                                    <td>
                                        <b><span id="spnNomd"></span></b>
                                    </td>
                                    <td>
                                        CNPJ/CPF:
                                    </td>
                                    <td>
                                        <b><span id="spnCgcd"></span></b>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </td>
            </tr>
            <tr>
                <td colspan="4">
                    <div class="panel panel-primary">
                        <div class="panel-heading">NOTAS FISCAIS</div>
                        <div class="panel-body">
                            <div class="row">
                                <div class="col-md-4"><b>NR. NF.</b></div>
                                <div class="col-md-4"><b>PESO KG</b></div>
                                <div class="col-md-4"><b>QT. VOLUME</b></div>
                                <div class="col-md-4">.col-md-4</div>
                                <div class="col-md-4">.col-md-4</div>
                                <div class="col-md-4">.col-md-4</div>
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </table>
    </div>
</div>
<script>
    var goSlRede = document.getElementById("sltRede");
    var goSlCnpj = document.getElementById("sltCnpj");
    var goTxCnpj = document.getElementById("txtCnpj");
    var goTxNcpf = document.getElementById("txtNcpf");
    var goSlNota = document.getElementById("sltNota");
    var goNrNota = document.getElementById("nroNota");
    var goDvErro = document.getElementById("divErro");
    var goDvCtrc = document.getElementById("divCtrc");
    var goSpNume = document.getElementById("spnNume");
    var goSpData = document.getElementById("spnData");
    var goSpFlor = document.getElementById("spnFlor");
    var goSpFldt = document.getElementById("spnFldt");
    var goSpTfre = document.getElementById("spnTfre");
    var goSpNomr = document.getElementById("spnNomr");
    var goSpCgcr = document.getElementById("spnCgcr");
    var goSpNomd = document.getElementById("spnNomd");
    var goSpCgcd = document.getElementById("spnCgcd");

    $(function ($) {
        $(".maskCnpj").mask("99.999.999/9999-99");
        $(".maskNcpf").mask("999.999.999-99");
    });

    enterTeclado2("txtCnpj", "nroNota");
    enterTeclado2("txtNcpf", "nroNota");
    enterTeclado3("nroNota", "btnRast", "btnRast");
</script>